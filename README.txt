##2025_sc_iso_paper
	Analysis suite accompanying the manuscript "Single cell long read sequencing of the experience-induced transcriptome"
	--Sheridan Cavalier 2025

## Description
	Scripts for processing ONT reads generated by 10X Genomics and R2C2 library preparation.
 # READ PROCESSING AND SORTING
  1. Concatameric ONT reads generated by R2C2 are filtered and deconcatenated into consensus reads.
	2. 10X barcodes and UMI sequences are determined for each consensus read that has the appropriate 10X adapters.
  3. Barcodes are demultiplexed first by exact matching to 10X whitelist, a barcode shortlist is generated from these matched barcodes.
     Reads that don't have exact barcode matches are categorized as belonging to a barcode in the shortlist if L < 3.
  4. Reads are mapped to the given reference genome with Minimap2 and assigned to a genomic feature with FeatureCounts.
     Reads with the same barcode that map to the same genomic feature are collapsed if their UMIs are within L < 2.
  5. Barcode rank is determined by UMI count and a percentile-based strategy is used to determine cell barcodes above background. 
 # GENERATING GENE COUNT MATRIX
	6. Reads within each barcode are mapped to the given reference genome with Minimap2. 
     Each read is assigned to a genomic feature with FeatureCounts based on its primary alignment.
	7. Gene counts per barcode are formatted for Seurat into three files: 
     barcodes.tsv, features.tsv, and matrix.mtx
 # GENERATING ISOFORM COUNT MATRIX
	8. Reads within each barcode are mapped to the given reference transcriptome with Minimap2. 
	9. Isoform quantification with Salmon is performed on resulting transcriptome alignment files. 
  10. Integer count values (raw) reported by Salmon for each isoform are recorded for each barcode. 
      Isoform counts per barcode are formatted for Seurat input. 
  